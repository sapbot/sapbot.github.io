var captcha=angular.module("captcha",[]);captcha.constant("captchaConstants",{template:"<div id='{{captchaElem.id}}' ng-show='captchaElem.isVisible'></div>",googleTemplate:"google-captcha-template",fcTemplate:"fun-captcha-template",fcModalTemplate:"fun-captcha-modal-template"}),captcha.directive("captcha",["$log","$parse","captchaConstants","captchaInterface",function(e,o,n,t){return{restrict:"A",template:n.template,link:function(n,a,i){function c(e,o,i,c){var l,s;a.find("#"+n.captchaElem.id);n.captchaElem.isVisible=!0,l=function(){a.find("#"+n.captchaElem.id).empty(),n.captchaElem.isVisible=!1,angular.isFunction(o)&&o()},s=function(){angular.isFunction(i)&&i()},r?t.reset(e,l,s,c):(t.render(n.captchaElem.id,e,l,s,c),r=!0,t.execute())}var r,l,s;n.captchaElem={isVisible:!1},r=!1,l=o(i.captchaModel)(n),n.captchaElem.id=l.id||t.ids.defaultCaptcha,s=n.$watch((function(){return l.isActivated}),(function(t){if(t){var a=o(i.onCaptchaSuccess)(n)||angular.noop,r=o(i.onCaptchaError)(n)||angular.noop,s=o(i.onCaptchaResponse)(n)||angular.noop,d=o(i.captchaType)(n);if(!d)return void e.debug("[Captcha Error] captcha type cannot be empty");c(d,a,r,s),l.isActivated=!1}}),!0),n.$on("$destroy",(function(){s&&s()}))}}}]),captcha.factory("captchaInterface",["$q",function(){var e=Roblox.Captcha||{};return{types:e.types,ids:e.ids,setEndpoint:e.setEndpoint,setInvisibleMode:e.setInvisibleMode,setSiteKey:e.setSiteKey,reset:e.reset,render:e.render,execute:e.execute}}]),captcha.factory("funCaptchaInterface",["$q",function(){var e=Roblox.FunCaptcha||{};return{ids:Roblox.CaptchaConstants.ids,types:e.types,reset:e.reset,render:e.render}}]),captcha.directive("funCaptcha",["$log","$uibModal","captchaConstants","funCaptchaInterface",function(e,o,n,t){return{restrict:"A",scope:{captchaModel:"=",onFunCaptchaSuccess:"&",onFunCaptchaError:"&",onFunCaptchaSolved:"&",onFunCaptchaLoaded:"&",onFunCaptchaSuppress:"&",onFunCaptchaShown:"&",onFunCaptchaClosed:"&",captchaType:"=",credentialsValue:"=",credentialsType:"=",showInModal:"="},templateUrl:n.fcTemplate,link:function(a,i){function c(){a.showInModal&&(a.showContainer=!1,(l=o.open({templateUrl:n.fcModalTemplate,keyboard:!1,backdrop:"static"})).rendered.then((function(){s=angular.element("#funcaptcha-modal-body"),d=angular.element("#"+a.captchaElem.id).detach(),s.append(d),a.showContainer=!0})),l.result.then((function(){i.append(angular.element("#"+a.captchaElem.id).detach()),a.showContainer=!1,a.onFunCaptchaClosed&&a.onFunCaptchaClosed()}))),a.onFunCaptchaShown&&a.onFunCaptchaShown()}function r(){a.showInModal&&l&&l.close(),a.onFunCaptchaSolved&&a.onFunCaptchaSolved()}var l,s,d,u,p=a.captchaModel;a.captchaElem={id:p.id},a.showContainer=!0,u=a.$watch((function(){return p.isActivated}),(function(o){if(o){var n={successCb:a.onFunCaptchaSuccess||angular.noop,errorCb:function(e){a.onFunCaptchaError&&a.onFunCaptchaError({errorCode:e})},solvedCb:r,loadedCb:a.onFunCaptchaLoaded||angular.noop,suppressCb:a.onFunCaptchaSuppress||angular.noop,shownCb:c,cType:a.captchaType};if(!n.cType)return void e.debug("[Captcha Error] captcha type cannot be empty");p.extraValidationParams?n.extraValidationParams=p.extraValidationParams:a.credentialsValue&&a.credentialsType&&(n.extraValidationParams={credentialsValue:a.credentialsValue,credentialsType:a.credentialsType}),t.render(a.captchaElem.id,n),p.isActivated=!1}}),!0),a.$on("$destroy",(function(){u&&u()}))}}}]),void 0===(Roblox=Roblox||{}).SocialLogin&&(Roblox.SocialLogin=new function(){function e(e){var t=$("#SocialIdentitiesInformation").data("rbx-login");$.ajax({url:t,method:"POST",data:{currentUid:e.UID},success:n,error:o})}function o(){$(".connect-button[data-rbx-provider]").each((function(){var e=$(this).data("rbx-provider");$("#connect-"+e).text("Sorry, an error occurred. Please try again later.")}))}function n(){gigya.socialize.getUserInfo({callback:t})}function t(e){var o=[];$(".connect-button[data-rbx-provider]").each((function(){o.push($(this.valueOf()).data("rbx-provider"))})),$(o).each((function(){var o=this.valueOf(),n="connect-"+o;e.user.identities.hasOwnProperty(o)?($("#"+n+" .connect-button").hide(),$("#"+n+" .nickname").text(e.user.identities[o].nickname),$("#"+n+" .disconnect-link").html("Disconnect"),"facebook"===o&&$("#FacebookConnectCard").length&&($("#FacebookConnectCard p").html("You've successfully connected as: <b>"+e.user.nickname+"</b>"),$("#FacebookConnectCard #connect-facebook").hide(),$("#FacebookConnectCard").fadeOut(5e3))):($("#"+n+" .nickname").html(""),$("#"+n+" .disconnect-link").html(""),$("#"+n+" .connect-button").show())}))}return{updateLoginStatus:function(){gigya.socialize.getUserInfo({callback:e})},showConnectionsUi:n,addConnection:function(e){gigya.socialize.addConnection({provider:e,callback:function(){var e=$("#SocialIdentitiesInformation").data("rbx-update"),o="socialStatusBar";$.ajax({url:e,method:"POST",success:function(){n()},error:function(e){$("#"+o).html(JSON.parse(e.responseText).message),$("#"+o).show().delay(5e3).fadeOut(1e3)}})}})},removeConnection:function(e){var o=$("#SocialIdentitiesInformation").data("rbx-disconnect"),t="socialStatusBar";$.ajax({url:o,method:"POST",data:{provider:e},success:function(){n()},error:function(e){$("#"+t).html(JSON.parse(e.responseText).message),$("#"+t).show().delay(5e3).fadeOut(1e3)}})},login:function(e,o){var n,t=$("#SocialIdentitiesInformation").data("rbx-login-redirect-url");void 0!==t&&(n={provider:e,authFlow:o,redirectMethod:"post",redirectURL:"https://"+window.location.hostname+(window.location.port?":"+window.location.port:"")+t},gigya.socialize.login(n))}}}),$((function(){void 0!==$("#SocialIdentitiesInformation").data("user-is-authenticated")&&Roblox.SocialLogin.updateLoginStatus(),$(".connect-button").click((function(){Roblox.SocialLogin.addConnection($(this).data("rbx-provider"))})),$(".disconnect-link").click((function(){Roblox.SocialLogin.removeConnection($(this).data("rbx-provider"))})),$("body").on("click",".social-login",(function(e){var o=$("#SocialIdentitiesInformation"),n=o.data("context");Roblox.FormEvents&&n&&Roblox.FormEvents.SendInteractionClick(n,"fbLoginSubmit"),void 0!==o.data("force-use-redirect")?Roblox.SocialLogin.login($(this).data("rbx-provider"),"redirect"):Roblox.SocialLogin.login($(this).data("rbx-provider"),"popup"),e.preventDefault()}))})),void 0===Roblox&&(Roblox={}),void 0===Roblox.FormEvents&&(Roblox.FormEvents=function(){function e(e,o,n){Roblox.EventStream&&Roblox.EventStream.SendEvent(e,o,n)}return{SendValidationFailed:function(o,n,t,a){e("formValidation",o,{msg:a,input:t,field:n,vis:!0})},SendInteractionFocus:function(o,n){e("formInteraction",o,{aType:"focus",field:n})},SendInteractionOffFocus:function(o,n,t){var a={aType:"offFocus",field:n};t&&(a.input=t),e("formInteraction",o,a)},SendInteractionClick:function(o,n,t,a){var i={aType:"click",field:n};t&&(i.input=t),a&&(i=$.extend(i,a)),e("formInteraction",o,i)}}}());var Roblox,formEvents=angular.module("roblox.formEvents",[]);formEvents.directive("rbxFormInteraction",(function(){return{require:"^form",restrict:"A",link:function(e,o,n,t){var a=n.sendInputValue;o.bind("blur",(function(){if(Roblox.FormEvents){var e,o=angular.element(this);a&&(e=o.val()),Roblox.FormEvents.SendInteractionOffFocus(t.context,o.attr("name"),e)}})).bind("focus",(function(){Roblox.FormEvents&&Roblox.FormEvents.SendInteractionFocus(t.context,angular.element(this).attr("name"))}))}}})),formEvents.directive("rbxFormContext",(function(){return{require:"form",restrict:"A",link:function(e,o,n,t){var a=t.$name;t.context=n.context+a.charAt(0).toUpperCase()+a.substr(1)}}})),robloxApp.constant("urlConstants",{urlQueryStringPrefix:"?",urlQueryParameterSeparator:"&",hashSign:"#"}),robloxApp.constant("phoneConstants",{templates:{verifyPhoneModal:"verify-phone-modal"},urls:{phonePrefixes:"/v1/countries/phone-prefix-list",addPhone:"/v1/phone",verifyPhone:"/v1/phone/verify",resendCode:"/v1/phone/resend"},modalTypes:{addPhone:"addPhone",verifyPhone:"verifyPhone"},minimumPhoneLength:4,underscore:"_",phonePrefixCharacter:"+",defaultCountryCode:"US",unitedStatesPrefix:{name:"United States",localizedName:"United States",code:"US",prefix:1}}),robloxApp.factory("phoneService",["$q","httpService","phoneConstants",function(e,o,n){var t=n.urls.phonePrefixes,a=n.defaultCountryCode;return{getPhonePrefixes:function(e){var n={url:e+t};return o.httpGet(n,null).then((function(e){var o;return _.reject(e,(function(e){return e.code===a&&(o=e,!0)})),o&&e.unshift(o),e}))},addPhone:function(e){var t={url:Roblox.EnvironmentUrls.accountInformationApi+n.urls.addPhoneV2},a={countryCode:e.countryCode,prefix:e.prefix,phone:e.phone,password:e.password};return o.httpPost(t,a)},verifyPhone:function(e){var t={url:Roblox.EnvironmentUrls.accountInformationApi+n.urls.verifyPhoneV2},a={code:e.code};return o.httpPost(t,a)},resendCode:function(){var e={url:Roblox.EnvironmentUrls.accountInformationApi+n.urls.resendCodeV2};return o.httpPost(e)},isPhoneNumber:function(e){return!(!e||e.length<n.minimumPhoneLength)&&(!!/\d/.test(e)&&/^[\d|\W|_]+$/.test(e))}}}]),void 0===Roblox&&(Roblox={}),void 0===Roblox.GenericConfirmation&&(Roblox.GenericConfirmation=function(){function e(e){e.hasClass(r)?e.addClass(d):e.hasClass(i)?e.addClass(l):e.hasClass(c)&&e.addClass(s)}function o(e){return!!(e.hasClass(s)||e.hasClass(d)||e.hasClass(l))}function n(e){f.isOpen=!1,void 0!==e?$.modal.close(e):$.modal.close()}function t(e){n(),"function"==typeof e&&e()}function a(e){if("function"==typeof e){var o=e();if("undefined"!==o&&0==o)return!1}n()}var i="btn-primary",c="btn-neutral",r="btn-negative",l="btn-disabled-primary",s="btn-disabled-neutral",d="btn-disabled-negative",u="#roblox-confirm-btn",p="#roblox-decline-btn",f={isOpen:!1},m={overlayClose:!0,escClose:!0,opacity:80,overlayCss:{backgroundColor:"#000"},onClose:function(){f.isOpen=!1,n()}};return{open:function(e){var n,i,l,s,d;f.isOpen=!0,n={titleText:"",bodyContent:"",footerText:"",acceptText:Roblox.Resources.GenericConfirmation.yes,declineText:Roblox.Resources.GenericConfirmation.No,acceptColor:c,declineColor:r,xToCancel:!1,onAccept:function(){return!1},onDecline:function(){return!1},onCancel:function(){return!1},imageUrl:null,allowHtmlContentInBody:!1,allowHtmlContentInFooter:!1,dismissable:!0,fieldValidationRequired:!1,onOpenCallback:function(){}},e=$.extend({},n,e),m.overlayClose=e.dismissable,m.escClose=e.dismissable,(i=$(u)).html(e.acceptText),i.attr("class","btn-large "+e.acceptColor),i.unbind(),i.bind("click",(function(){return o(i)||(e.fieldValidationRequired?a(e.onAccept):t(e.onAccept)),!1})),(l=$(p)).html(e.declineText),l.attr("class","btn-large "+e.declineColor),l.unbind(),l.bind("click",(function(){return o(l)||t(e.onDecline),!1})),$('[data-modal-handle="confirmation"] div.Title').text(e.titleText),s=$("[data-modal-handle='confirmation']"),null==e.imageUrl?s.addClass("noImage"):(s.find("img.GenericModalImage").attr("src",e.imageUrl),s.removeClass("noImage")),e.allowHtmlContentInBody?$("[data-modal-handle='confirmation'] div.Message").html(e.bodyContent):$("[data-modal-handle='confirmation'] div.Message").text(e.bodyContent),""==$.trim(e.footerText)?$('[data-modal-handle="confirmation"] div.ConfirmationModalFooter').hide():$('[data-modal-handle="confirmation"] div.ConfirmationModalFooter').show(),e.allowHtmlContentInFooter?$('[data-modal-handle="confirmation"] div.ConfirmationModalFooter').html(e.footerText):$('[data-modal-handle="confirmation"] div.ConfirmationModalFooter').text(e.footerText),$("[data-modal-handle='confirmation']").modal(m),(d=$("a.genericmodal-close")).unbind(),d.bind("click",(function(){return t(e.onCancel),!1})),e.xToCancel||d.hide(),e.onOpenCallback()},close:n,disableButtons:function(){var o=$(u),n=$(p);e(o),e(n)},enableButtons:function(){var e=$(u),o=$(p),n=s+" "+d+" "+l;e.removeClass(n),o.removeClass(n)},clickYes:function(){f.isOpen&&$(u).click()},clickNo:function(){$(p).click()},status:f,green:i,blue:c,gray:r,none:"btn-none"}}()),$(document).keypress((function(e){Roblox.GenericConfirmation.status.isOpen&&13===e.which&&Roblox.GenericConfirmation.clickYes()})),void 0===Roblox&&(Roblox={}),void 0===Roblox.Dialog&&(Roblox.Dialog=function(){function e(e){e.hasClass(l)?e.addClass(u):e.hasClass(c)?e.addClass(s):e.hasClass(r)&&e.addClass(d)}function o(e){return!!(e.hasClass(d)||e.hasClass(u)||e.hasClass(s))}function n(e){e.hasClass(u)?(e.removeClass(u),e.addClass(l)):e.hasClass(s)?(e.removeClass(s),e.addClass(c)):e.hasClass(d)&&(e.removeClass(d),e.addClass(r))}function t(e){h.isOpen=!1,void 0!==e?$.modal.close(e):$.modal.close(),$("#rbx-body").removeClass("modal-mask")}function a(e){t(),"function"==typeof e&&e()}var i=".simplemodal-container",c="btn-primary-md",r="btn-secondary-md",l="btn-control-md",s="btn-primary-md disabled",d="btn-secondary-md disabled",u="btn-control-md disabled",p=".modal-btns #confirm-btn",f=".modal-btns #decline-btn",m="#modal-checkbox-input",h={isOpen:!1},b={overlayClose:!0,escClose:!0,opacity:80,zIndex:1040,overlayCss:{backgroundColor:"#000"},onClose:t,focus:!1},C={Yes:"Yes",No:"No",Agree:"Agree"};return{open:function(c){var s,d,u,x,v,g;h.isOpen=!0,s={titleText:"",bodyContent:"",footerText:"",footerMiddleAligned:!1,acceptText:Roblox.Lang.ControlsResources["Action.Yes"]||C.Yes,declineText:Roblox.Lang.ControlsResources["Action.No"]||C.No,acceptColor:r,declineColor:l,xToCancel:!1,onAccept:function(){return!1},onDecline:function(){return!1},onCancel:function(){return!1},imageUrl:null,showAccept:!0,showDecline:!0,allowHtmlContentInBody:!1,allowHtmlContentInFooter:!1,dismissable:!0,fieldValidationRequired:!1,onOpenCallback:function(){},onCloseCallback:t,cssClass:null,checkboxAgreementText:Roblox.Lang.ControlsResources["Action.Agree"]||C.Agree,checkboxAgreementRequired:!1},c=$.extend({},s,c),b.overlayClose=c.dismissable,b.escClose=c.dismissable,c.onCloseCallback&&(b.onClose=function(){c.onCloseCallback(),t()}),(d=$(p)).html(c.acceptText),d.attr("class",c.acceptColor),d.unbind(),d.bind("click",(function(){return o(d)||(c.fieldValidationRequired?function(e){if("function"==typeof e){var o=e();if("undefined"!==o&&0==o)return!1}t()}(c.onAccept):a(c.onAccept)),!1})),(u=$(f)).html(c.declineText),u.attr("class",c.declineColor),u.unbind(),u.bind("click",(function(){return o(u)||a(c.onDecline),!1})),(x=$(m)).unbind(),x.bind("change",(function(){x.is(":checked")?n(d):e(d)})),(v=$('[data-modal-type="confirmation"]')).find(".modal-title").text(c.titleText),null==c.imageUrl?v.addClass("noImage"):(v.find("img.modal-thumb").attr("src",c.imageUrl),v.removeClass("noImage")),h.extraClass&&(v.removeClass(h.extraClass),h.extraClass=!1),null!=c.cssClass&&(v.addClass(c.cssClass),h.extraClass=c.cssClass),c.allowHtmlContentInBody?v.find(".modal-message").html(c.bodyContent):v.find(".modal-message").text(c.bodyContent),c.checkboxAgreementRequired?(e(d),v.find(".modal-checkbox.checkbox > input").prop("checked",!1),v.find(".modal-checkbox.checkbox > label").text(c.checkboxAgreementText),v.find(".modal-checkbox.checkbox").show()):(v.find(".modal-checkbox.checkbox > input").prop("checked",!0),v.find(".modal-checkbox.checkbox").hide()),""==$.trim(c.footerText)?v.find(".modal-footer").hide():v.find(".modal-footer").show(),c.allowHtmlContentInFooter?v.find(".modal-footer").html(c.footerText):v.find(".modal-footer").text(c.footerText),c.footerMiddleAligned&&v.find(".modal-footer").addClass("modal-footer-center"),v.modal(b),(g=$(i+" .modal-header .close")).unbind(),g.bind("click",(function(){return a(c.onCancel),!1})),c.xToCancel||g.hide(),c.showAccept||d.hide(),c.showDecline||u.hide(),$("#rbx-body").addClass("modal-mask"),c.onOpenCallback()},close:t,disableButtons:function(){var o=$(p),n=$(f);e(o),e(n)},enableButtons:function(){var e=$(p),o=$(f);n(e),n(o)},clickYes:function(){h.isOpen&&$(p).click()},clickNo:function(){$(f).click()},status:h,toggleProcessing:function(e,o){var n=$(".modal-body");e?(n.find(".modal-btns").hide(),n.find(".modal-processing").show()):(n.find(".modal-btns").show(),n.find(".modal-processing").hide()),void 0!==o&&""!==o&&$.modal.close("."+o)},green:c,blue:r,white:l,none:"btn-none"}}()),$(document).keypress((function(e){Roblox.Dialog.isOpen&&13===e.which&&Roblox.Dialog.clickYes()})),(Roblox=Roblox||{}).DeviceMeta=function(){var e=document.querySelector('meta[name="device-meta"]');if(null!==e){var o=e.dataset||{},n={android:"android",ios:"ios",xbox:"xbox",uwp:"uwp",amazon:"amazon",win32:"win32",universalapp:"universalApp",unknown:"unknown"},t={computer:"computer",tablet:"tablet",phone:"phone",console:"console"};return function(){return{deviceType:t[o.deviceType]||"",appType:n[o.appType]||"",isInApp:"true"===o.isInApp,isDesktop:"true"===o.isDesktop,isPhone:"true"===o.isPhone,isTablet:"true"===o.isTablet,isConsole:"true"===o.isConsole,isAndroidApp:"true"===o.isAndroidApp,isIosApp:"true"===o.isIosApp,isUWPApp:"true"===o.isUwpApp,isXboxApp:"true"===o.isXboxApp,isAmazonApp:"true"===o.isAmazonApp,isWin32App:"true"===o.isWin32App,isStudio:"true"===o.isStudio,isIosDevice:"true"===o.isIosDevice,isAndroidDevice:"true"===o.isAndroidDevice,isUniversalApp:"true"===o.isUniversalApp}}}console.debug("Error loading device information from meta tag - please check if meta tag is present")}(),Roblox&&Roblox.BundleDetector&&Roblox.BundleDetector.bundleDetected("page");