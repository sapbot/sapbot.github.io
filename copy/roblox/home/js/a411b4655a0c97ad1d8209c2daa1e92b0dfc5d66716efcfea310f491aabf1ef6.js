!function(){"use strict";var e={n:function(r){var t=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(t,{a:t}),t},d:function(r,t){for(var n in t)e.o(t,n)&&!e.o(r,n)&&Object.defineProperty(r,n,{enumerable:!0,get:t[n]})},o:function(e,r){return Object.prototype.hasOwnProperty.call(e,r)}},r=CoreUtilities,t=React,n=e.n(t),a=ReactDOM,o=PropTypes,c=e.n(o),i=ReactUtilities,u=(o=Roblox).EnvironmentUrls.userAgreementsServiceApi,s=o.EnvironmentUrls.universalAppConfigurationApi,l=function(){var e={withCredentials:!0,url:"".concat(u,"/v1/agreements-resolution/").concat("web")};return r.httpService.get(e)},d=function(e){var t={withCredentials:!0,url:"".concat(u,"/v1/acceptances")};e={acceptances:e.map((function(e){return{agreementId:e}}))};return r.httpService.post(t,e)},f=ReactStyleGuide,m="Roblox.UserAgreements",p={TermsOfService:"Modal.Agreement.TermsOfService",PrivacyPolicy:"Modal.Agreement.PrivacyPolicy",RiderTerms:"Modal.Agreement.RiderTerms",ChildrenPrivacyPolicy:"Modal.Agreement.ChildrenPrivacyPolicy"},v=CoreRobloxUtilities,g=HeaderScripts,h=function(){var e={withCredentials:!0,url:"".concat(s,"/v1/behaviors/").concat("user-agreements-policy","/content")};return r.httpService.get(e)};function y(e,r,t,n,a,o,c){try{var i=e[o](c),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,a)}var b={shouldFetchAgreements:function(){var e,r=(e=regeneratorRuntime.mark((function e(r){var t,n,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g.authenticatedUser.isAuthenticated){e.next=3;break}return e.abrupt("return",!1);case 3:e.prev=3,t=v.localStorageService.getLocalStorage(m),e.next=12;break;case 7:if(e.prev=7,e.t0=e.catch(3),e.t0 instanceof SyntaxError)return e.abrupt("return",!0);e.next=11;break;case 11:throw e.t0;case 12:if(null===t)return e.abrupt("return",!0);e.next=14;break;case 14:if(n=t.lastFetchTimestamp,n=Date.parse(n),Number.isNaN(n))return e.abrupt("return",!0);e.next=18;break;case 18:if(t.doesUserNeedToAcceptAgreements)return e.abrupt("return",!0);e.next=21;break;case 21:return a=r.getTime(),e.prev=22,e.next=25,h();case 25:o=(o=e.sent).data.cooldownPeriodInMs,e.next=32;break;case 29:e.prev=29,e.t1=e.catch(22),o=864e5;case 32:return e.abrupt("return",n+o<a);case 33:case"end":return e.stop()}}),e,null,[[3,7],[22,29]])})),function(){var r=this,t=arguments;return new Promise((function(n,a){var o=e.apply(r,t);function c(e){y(o,n,a,c,i,"next",e)}function i(e){y(o,n,a,c,i,"throw",e)}c(void 0)}))});return function(){return r.apply(this,arguments)}}(),updateDoesUserNeedToAcceptAgreements:function(e,r){if(r=1<arguments.length&&void 0!==r?r:null,e&&!(r instanceof Date))throw new TypeError("if doesUserNeedToAcceptAgreements is true then must provide a valid Date");var t,n={doesUserNeedToAcceptAgreements:e};if(r instanceof Date)n.lastFetchTimestamp=r.toISOString();else try{t=v.localStorageService.getLocalStorage(m),n.lastFetchTimestamp=t.lastFetchTimestamp}catch(e){if(e instanceof SyntaxError)return void v.localStorageService.removeLocalStorage(m);throw e}try{v.localStorageService.setLocalStorage(m,n)}catch(e){console.error("Error updating doesUserNeedToAcceptAgreements ".concat(e))}}};function A(e,r,t,n,a,o,c){try{var i=e[o](c),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,a)}function w(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var S=(0,f.createModal)(),x=(2,o=function(e){if(Array.isArray(e))return e}(S=S)||function(e,r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var t=[],n=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(n=(c=i.next()).done)&&(t.push(c.value),2!==t.length);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw o}}return t}}(S)||function(e,r){if(e){if("string"==typeof e)return w(e,2);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?w(e,2):void 0}}(S)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],T=o[1];(o=function(e){var r=e.translate,a=e.agreements,o=function(){var e=p,t=a.map((function(t){return n().createElement("li",{key:t.id,className:"agreement-item"},n().createElement(f.Link,{url:t.displayUrl,target:"_blank",rel:"noreferrer",className:"text-link"},r(e[t.agreementType])))}));return n().createElement("ul",null,t)},c=function(){return n().createElement("div",null,r("Modal.Body"))};e=n().createElement("div",{className:"agreement-modal-body"},n().createElement(c,null),n().createElement(o,{agreements:a})),c="Modal.Agree";return(0,t.useEffect)((function(){T.open()}),[]),o=function(){var e,r=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d(a.map((function(e){return e.id})));case 3:b.updateDoesUserNeedToAcceptAgreements(!1),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error("Error accepting user agreements ".concat(e.t0));case 9:case"end":return e.stop()}}),e,null,[[0,6]])})),function(){var r=this,t=arguments;return new Promise((function(n,a){var o=e.apply(r,t);function c(e){A(o,n,a,c,i,"next",e)}function i(e){A(o,n,a,c,i,"throw",e)}c(void 0)}))});return function(){return r.apply(this,arguments)}}(),n().createElement(x,{title:r("Modal.Title"),body:e,neutralButtonText:r(c),onNeutral:o,id:"user-agreements-checker-modal",closeable:!1})}).propTypes={translate:c().func.isRequired,agreements:c().arrayOf(c().shape({displayUrl:c().string.isRequired,id:c().string.isRequired,agreementType:c().string.isRequired,clientType:c().string.isRequired,regulationType:c().string.isRequired})).isRequired};var R=o;function E(e,r,t,n,a,o,c){try{var i=e[o](c),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,a)}function U(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}(o=function(e){var r=e.translate,a=function(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var t=[],n=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(n=(c=i.next()).done)&&(t.push(c.value),!r||t.length!==r);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw o}}return t}}(e,r)||function(e,r){if(e){if("string"==typeof e)return U(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?U(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,t.useState)([]),2),o=(e=a[0],a[1]);return(0,t.useEffect)((function(){var e=new Date;!function(){var r,t=(r=regeneratorRuntime.mark((function r(){var t,n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=!1,r.prev=1,r.next=4,b.shouldFetchAgreements(e);case 4:t=r.sent,r.next=10;break;case 7:r.prev=7,r.t0=r.catch(1),console.error("Error calling shouldFetchAgreements ".concat(r.t0));case 10:if(t)return r.prev=11,r.next=14,l();r.next=22;break;case 14:n=r.sent,o(n.data),0<n.data.length?b.updateDoesUserNeedToAcceptAgreements(!0,e):b.updateDoesUserNeedToAcceptAgreements(!1,e),r.next=22;break;case 19:r.prev=19,r.t1=r.catch(11),console.error("Error fetching or caching user agreements ".concat(r.t1));case 22:case"end":return r.stop()}}),r,null,[[1,7],[11,19]])})),function(){var e=this,t=arguments;return new Promise((function(n,a){var o=r.apply(e,t);function c(e){E(o,n,a,c,i,"next",e)}function i(e){E(o,n,a,c,i,"throw",e)}c(void 0)}))});return function(){return t.apply(this,arguments)}}()()}),[]),0<e.length?n().createElement(R,{translate:r,agreements:e}):null}).propTypes={translate:c().func.isRequired};var k=(0,i.withTranslations)(o,{common:["CommonUI.UserAgreements","CommonUI.Controls"],feature:null});(0,r.ready)((function(){var e=document.getElementById("user-agreements-checker-container");null!==e&&(0,a.render)(n().createElement(k,null),e)}))}(),window.Roblox&&window.Roblox.BundleDetector&&window.Roblox.BundleDetector.bundleDetected("UserAgreementsChecker");